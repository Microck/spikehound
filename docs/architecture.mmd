flowchart TD
    AM([Azure Monitor\nCost Alert])

    CA["Cost Analyst"]
    RA["Resource Agent"]
    HA["History Agent"]

    AM --> CA & RA & HA

    DA["Diagnosis Agent\nAI Foundry / GPT-4o"]

    CA & RA & HA --> DA

    SN["Slack"]
    DN["Discord"]

    DA -->|"Remediation Plan"| SN & DN

    GATE{"Approve?"}

    SN & DN -->|"Human decision"| GATE

    AZ["Azure Compute\nstop_vm"]
    SAFE["Skipped\nsafe default"]

    GATE -->|"Approve + enabled"| AZ
    GATE -->|"Reject / disabled"| SAFE

    classDef azure   fill:#e6f3ff,stroke:#0066cc,color:#003d7a
    classDef agent   fill:#f0f7ee,stroke:#3a7d44,color:#1b4332
    classDef human   fill:#fff8e1,stroke:#f9a825,color:#5d4037
    classDef safe    fill:#e8f5e9,stroke:#2e7d32,color:#1b5e20
    classDef neutral fill:#fafafa,stroke:#9e9e9e,color:#212121

    class AM,AZ azure
    class CA,RA,HA,DA agent
    class SN,DN human
    class SAFE safe
    class GATE neutral
